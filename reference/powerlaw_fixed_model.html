<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Fits a neutral model with the power-law exponent equal:
$$y(f) = \frac{\mu}{\beta n} \frac{1}{f^2}$$
where \( \mu/\beta \) is the mutation rate per effective cell division, and
n is the number of bins in the spectrum. The power-law exponent of this
model equals 2, as expected by
Williams et al. (2018) and
Durrett (2013).
This model is valid under the assumptions of exponential population growth,
constant mutation rate, and absence of selectively advantageous micro-clones
desctibed by
Tung and Durrett (2021)."><title>Fitting neutral models — powerlaw_fixed_model • cevomod</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fitting neutral models — powerlaw_fixed_model"><meta property="og:description" content="Fits a neutral model with the power-law exponent equal:
$$y(f) = \frac{\mu}{\beta n} \frac{1}{f^2}$$
where \( \mu/\beta \) is the mutation rate per effective cell division, and
n is the number of bins in the spectrum. The power-law exponent of this
model equals 2, as expected by
Williams et al. (2018) and
Durrett (2013).
This model is valid under the assumptions of exponential population growth,
constant mutation rate, and absence of selectively advantageous micro-clones
desctibed by
Tung and Durrett (2021)."><meta property="og:image" content="https://pawelqs.github.io/cevomod/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cevomod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/get_started.html">Get Started</a>
    <a class="dropdown-item" href="../articles/cevodata_class.html">cevodata class</a>
    <a class="dropdown-item" href="../articles/fitting_models.html">Fitting models</a>
    <a class="dropdown-item" href="../articles/visualizations.html">Visualizations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fitting neutral models</h1>
      
      <div class="d-none name"><code>powerlaw_fixed_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a <em>neutral</em> model with the power-law exponent equal:
$$y(f) = \frac{\mu}{\beta n} \frac{1}{f^2}$$
where \( \mu/\beta \) is the mutation rate per effective cell division, and
n is the number of bins in the spectrum. The power-law exponent of this
model equals 2, as expected by
<a href="https://doi.org/10.1038/ng.3489" class="external-link">Williams et al. (2018)</a> and
<a href="https://doi.org/10.1214/11-aap824" class="external-link">Durrett (2013)</a>.
This model is valid under the assumptions of exponential population growth,
constant mutation rate, and absence of selectively advantageous micro-clones
desctibed by
<a href="https://doi.org/10.1371/journal.pcbi.1008701" class="external-link">Tung and Durrett (2021)</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fit_powerlaw_tail_fixed</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for cevodata</span></span>
<span><span class="fu">fit_powerlaw_tail_fixed</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  rsq_treshold <span class="op">=</span> <span class="fl">0.98</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"powerlaw_fixed"</span>,</span>
<span>  pct_left <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  pct_right <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">layer_lm_fits</span><span class="op">(</span><span class="va">cd</span>, model_name <span class="op">=</span> <span class="st">"powerlaw_fixed"</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>SNVs tibble object</p></dd>


<dt>...</dt>
<dd><p>other params passed to geom_segment()</p></dd>


<dt>rsq_treshold</dt>
<dd><p>R-squared tresholds to keep model as neutral</p></dd>


<dt>name</dt>
<dd><p>name in the models' slot</p></dd>


<dt>pct_left</dt>
<dd><p>drop pct of the lowerst frequency variants to improve fit</p></dd>


<dt>pct_right</dt>
<dd><p>drop pct of the highest frequency variants to improve fit</p></dd>


<dt>verbose</dt>
<dd><p>verbose?</p></dd>


<dt>cd</dt>
<dd><p>cevodata</p></dd>


<dt>model_name</dt>
<dd><p>modelname</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This model is fitted using the statistic
$$M(f) = \frac{\mu}{\beta} \frac{1}{f}$$ described by
<a href="https://doi.org/10.1038/ng.3489" class="external-link">Williams et al. (2016)</a>.
Using the equations described in
<a href="https://doi.org/10.1038/s41588-018-0128-6" class="external-link">Williams et al. (2018)</a>
evolutionary parameters of detected subclones can be calculated.</p>
    </div>
    <div class="section level2">
    <h2 id="functions">Functions<a class="anchor" aria-label="anchor" href="#functions"></a></h2>
    
<ul><li><p><code>layer_lm_fits()</code>: Add M(f) ~ 1/f models layer to M(f) ~ 1/f plot</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tcga_brca_test"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">snvs</span> <span class="op">&lt;-</span> <span class="fu"><a href="assays.html">SNVs</a></span><span class="op">(</span><span class="va">tcga_brca_test</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sample_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TCGA-AC-A23H-01"</span>,<span class="st">"TCGA-AN-A046-01"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="init_cevodata.html">init_cevodata</a></span><span class="op">(</span><span class="st">"Test"</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="assays.html">add_SNV_data</a></span><span class="op">(</span><span class="va">snvs</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="Mf_1f.html">calc_Mf_1f</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="sfs.html">calc_SFS</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">fit_powerlaw_tail_fixed</span><span class="op">(</span>rsq_treshold <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #5FAFD7;">Calculating Williams's M(f) ~ 1/f statistics</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #5FAFD7;">Fitting williams neutral models...</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cd</span><span class="op">$</span><span class="va">models</span><span class="op">$</span><span class="va">Mf_1f</span>, from <span class="op">=</span> <span class="fl">0.05</span>, to <span class="op">=</span> <span class="fl">0.4</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu">layer_lm_fits</span><span class="op">(</span><span class="va">cd</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="powerlaw_fixed_model-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Paweł Kuś.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

